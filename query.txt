CREATE TABLE `trylo`.`users` ( `user_id` INT NOT NULL , `user_name` VARCHAR(150) NOT NULL , `password` TINYTEXT NOT NULL , `created_at` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP , `updated_at` DATETIME on update CURRENT_TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP , `is_active` TINYINT NOT NULL DEFAULT '0' , PRIMARY KEY (`user_id`), INDEX (`user_name`), INDEX (`is_active`), FULLTEXT (`password`)) ENGINE = InnoDB;

ALTER TABLE `users` CHANGE `user_id` `user_id` INT(11) NOT NULL AUTO_INCREMENT;

INSERT INTO `users` (`user_id`, `user_name`, `password`, `is_active`) VALUES (NULL, 'admin', MD5('Admin@123'), 1);

CREATE TABLE `trylo`.`branch` ( `branch_id` INT NOT NULL AUTO_INCREMENT , `branch_name` TINYTEXT NOT NULL , `is_active` TINYINT NOT NULL DEFAULT '1' , `created_by` INT NOT NULL , `created_at` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP , `updated_at` DATETIME on update CURRENT_TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP , PRIMARY KEY (`branch_id`), INDEX (`is_active`)) ENGINE = InnoDB;

Bhavesh : for role management

CREATE TABLE `forms` ( `form_id` INT NOT NULL AUTO_INCREMENT , `form_name` VARCHAR(100) NOT NULL , `active_tab` VARCHAR(100) NOT NULL , `icon` TINYTEXT NOT NULL , `redirect_url` TINYTEXT NOT NULL , PRIMARY KEY (`form_id`)) ENGINE = InnoDB;

ALTER TABLE `users` ADD `branch_id` INT NOT NULL AFTER `is_active`, ADD `role_id` INT NOT NULL COMMENT '1: Super Admin 2: Admin 3: User' AFTER `branch_id`;

CREATE TABLE `assign_forms` ( `assign_form_id` INT NOT NULL AUTO_INCREMENT , `user_id` INT NOT NULL , `form_id` INT NOT NULL , PRIMARY KEY (`assign_form_id`)) ENGINE = InnoDB;

CREATE TRIGGER `AddedNewForm` BEFORE INSERT ON `forms` FOR EACH ROW INSERT INTO `assign_forms`(`user_id`, `form_id`) SELECT id, NEW.form_id FROM users where role_id = 1 OR role_id = 2

DROP TRIGGER IF EXISTS `AddedNewForm`;CREATE TRIGGER `AddedNewForm` BEFORE INSERT ON `forms` FOR EACH ROW INSERT INTO `assign_forms`(`user_id`, `form_id`) SELECT id, NEW.form_id FROM users where role_id = 2

Ajaj : for card listing

ALTER TABLE `maincrd` ADD `ISACTIVE` TINYINT NOT NULL DEFAULT '0' AFTER `TRUPWEB`;

Ajaj : for loyalty card listing

ALTER TABLE `trloyl` ADD `ISACTIVE` TINYINT NOT NULL DEFAULT '0' AFTER `LOP200`;

Bhavesh : for 200 denomination

ALTER TABLE trbil ADD RC200 DOUBLE DEFAULT NULL NULL;

ALTER TABLE trbil ADD PD200 DOUBLE DEFAULT NULL NULL;

Ajaj : for branch creation

ALTER TABLE `branch` ADD `address1` VARCHAR(50) NULL DEFAULT NULL AFTER `branch_name`, ADD `address2` VARCHAR(50) NULL DEFAULT NULL AFTER `address1`, ADD `address3` VARCHAR(50) NULL DEFAULT NULL AFTER `address2`, ADD `city` VARCHAR(50) NULL DEFAULT NULL AFTER `address3`, ADD `district` VARCHAR(50) NULL DEFAULT NULL AFTER `city`, ADD `state` VARCHAR(50) NULL DEFAULT NULL AFTER `district`, ADD `telephone1` VARCHAR(15) NULL DEFAULT NULL AFTER `state`, ADD `telephone2` VARCHAR(15) NULL DEFAULT NULL AFTER `telephone1`;


ALTER TABLE `branch` ADD `jurisdiction` VARCHAR(256) NULL DEFAULT NULL AFTER `telephone2`, ADD `tinno` VARCHAR(50) NULL DEFAULT NULL AFTER `jurisdiction`, ADD `prefix` VARCHAR(50) NULL DEFAULT NULL AFTER `tinno`, ADD `chnoofpoints` INT NULL DEFAULT NULL AFTER `prefix`, ADD `refnoofpoints` INT NULL DEFAULT NULL AFTER `chnoofpoints`, ADD `chrs` DOUBLE NULL DEFAULT NULL AFTER `refnoofpoints`, ADD `refrs` DOUBLE NULL DEFAULT NULL AFTER `chrs`, ADD `redaftminpoints` INT NULL DEFAULT NULL AFTER `refrs`, ADD `redperpoints` INT NULL DEFAULT NULL AFTER `redaftminpoints`, ADD `redvaluers` DOUBLE NULL DEFAULT NULL AFTER `redperpoints`, ADD `roundofflimit` DECIMAL NULL DEFAULT NULL AFTER `redvaluers`, ADD `mobileno` VARCHAR(10) NULL DEFAULT NULL AFTER `roundofflimit`, ADD `pettycashtype` INT NULL DEFAULT NULL AFTER `mobileno`, ADD `smscode` VARCHAR(20) NULL DEFAULT NULL AFTER `pettycashtype`, ADD `smslast` VARCHAR(20) NULL DEFAULT NULL AFTER `smscode`;


ALTER TABLE `branch` ADD `gstinno` VARCHAR(50) NULL DEFAULT NULL AFTER `smslast`, ADD `defaultmail` INT NULL DEFAULT NULL AFTER `gstinno`, ADD `bdaysms` TINYINT NULL DEFAULT NULL AFTER `defaultmail`, ADD `mrgsms` TINYINT NULL DEFAULT NULL AFTER `bdaysms`, ADD `bdaydiscdays` INT NULL DEFAULT NULL AFTER `mrgsms`, ADD `mrgdiscdays` INT NULL DEFAULT NULL AFTER `bdaydiscdays`, ADD `bdaydisc` DECIMAL NULL DEFAULT NULL AFTER `mrgdiscdays`, ADD `mrgdisc` DECIMAL NULL DEFAULT NULL AFTER `bdaydisc`, ADD `bdaysendbefore` INT NULL DEFAULT NULL AFTER `mrgdisc`, ADD `mrgsendbefore` INT NULL DEFAULT NULL AFTER `bdaysendbefore`;

Bhavesh : Add flag for delete transit bill 26-11-17

ALTER TABLE trtrbl ADD ISACTIVE TINYINT(1) DEFAULT 0 NULL;
ALTER TABLE trtrbl1 ADD ISACTIVE TINYINT(1) DEFAULT 0 NULL;